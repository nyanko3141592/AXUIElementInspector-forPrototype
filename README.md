# Slackメッセージ取得アプリ

このmacOSアプリケーションは、アクセシビリティAPIを使用してSlackアプリからメッセージを自動的に取得します。初回起動時に、アクセス権限を要求するアラートが表示されます。

## 特徴

- アクティブなアプリケーションを自動的に監視
- アクセシビリティAPIを使用してSlackアプリからメッセージを取得

## 必要要件

- macOS 10.12以降
- Xcode 11.0以降
- Swift 5.0以降

## インストール

1. **リポジトリをクローンする:**

   ```sh
   git clone https://github.com/nyanko3141592/AXUIElementInspector-forPrototype.git
   ```

2. **プロジェクトをXcodeで開く:**

3. **プロジェクトをビルドする:**

## 使用方法

### 初回セットアップ

初回起動時に、アプリケーションはアクセシビリティの権限を要求します。アラートの指示に従って必要な権限を付与してください：

1. `システム環境設定`を開きます。
2. `セキュリティとプライバシー` > `プライバシー` > `アクセシビリティ`に移動します。
3. 変更を加えるために鍵アイコンをクリックし、必要に応じて認証します。
4. リストにあるアプリケーションを見つけ、その横のボックスにチェックを入れてアクセシビリティアクセスを許可します。

### アプリケーションの実行

必要な権限を付与した後：

1. アプリケーションを起動します。
2. アプリは自動的にアクティブなアプリケーションの監視とSlackからのメッセージの取得を開始します。

## コード概要

### AppDelegate.swift

このファイルにはアプリケーションの主要なロジックが含まれています。以下は主要なコンポーネントの概要です：

- **変数:**
  - `activeApplicationName`: 現在アクティブなアプリケーションの名前を保持する。
  - `slackApp`: Slackアプリケーションを `AXUIElement` として扱う。

- **メソッド:**
  - `applicationDidFinishLaunching(_:)`: アプリケーションの起動が完了したときに呼ばれます。アクセシビリティ権限を確認し、権限が付与されている場合はセットアップと監視プロセスを開始します。
  - `setup()`: Slackと対話するために必要な要素を初期化します。
  - `monitorActiveApplication()`: アクティブなアプリケーションの変更を監視します。
